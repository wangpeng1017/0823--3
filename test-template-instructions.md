# 测试模板文件说明

## 创建测试Word模板

为了测试本地文档处理功能，您需要创建一个包含占位符的Word文档模板。

### 模板格式要求

1. **文件格式**: .docx (Word 2007及以上版本)
2. **占位符格式**: `{{占位符名称}}`
3. **编码**: UTF-8

### 示例模板内容

创建一个名为 `合同模板.docx` 的Word文档，包含以下内容：

```
                        汽车销售合同

甲方（卖方）：{{甲方公司名称}}
联系人：{{甲方联系人}}
联系电话：{{甲方电话}}
地址：{{甲方地址}}

乙方（买方）：{{乙方公司名称}}
联系人：{{乙方联系人}}
联系电话：{{乙方电话}}
地址：{{乙方地址}}

车辆信息：
车型：{{车型}}
颜色：{{颜色}}
数量：{{数量}}台
单价：{{单价}}元
总价：{{总金额}}元

合同条款：
1. 交付日期：{{交付日期}}
2. 付款方式：{{付款方式}}
3. 质保期：{{质保期}}

特别约定：
{{特别约定}}

甲方签字：________________    乙方签字：________________

签署日期：{{签署日期}}
```

### 支持的占位符类型

系统会自动识别以下类型的占位符：

1. **文本类型** (text)
   - 公司名称、联系人、地址等
   - 示例：`{{甲方公司名称}}`、`{{联系人}}`

2. **数字类型** (number)
   - 金额、数量、价格等
   - 示例：`{{总金额}}`、`{{数量}}`、`{{单价}}`

3. **日期类型** (date)
   - 各种日期字段
   - 示例：`{{签署日期}}`、`{{交付日期}}`

4. **邮箱类型** (email)
   - 邮箱地址
   - 示例：`{{联系邮箱}}`

5. **布尔类型** (boolean)
   - 是否选项
   - 示例：`{{是否同意}}`、`{{启用保险}}`

### 测试步骤

1. **创建模板文件**
   - 使用Microsoft Word创建新文档
   - 输入上述示例内容
   - 保存为 `合同模板.docx`

2. **测试上传**
   - 访问 http://localhost:3000/local-docs
   - 点击"选择文件"上传模板
   - 系统会自动解析占位符

3. **填写表单**
   - 系统会根据识别的占位符生成表单
   - 填写相应的数据
   - 点击"生成文档"

4. **下载结果**
   - 系统生成填充后的文档
   - 点击"下载文档"获取结果

### 高级功能测试

#### 复杂占位符
```
{{甲方公司名称}}
{{合同金额}}
{{签署日期}}
{{是否包含保险}}
{{联系邮箱}}
```

#### 表格中的占位符
可以在Word表格中使用占位符：

| 项目 | 内容 |
|------|------|
| 甲方 | {{甲方公司名称}} |
| 乙方 | {{乙方公司名称}} |
| 金额 | {{合同金额}} |

#### 条件内容
```
如果{{是否包含保险}}为是，则保险费用为{{保险费用}}元。
```

### 故障排除

#### 常见问题

1. **占位符未被识别**
   - 检查占位符格式是否正确 `{{名称}}`
   - 确保使用英文花括号
   - 避免占位符名称中包含特殊字符

2. **文档生成失败**
   - 确保模板文件是有效的.docx格式
   - 检查文件是否损坏
   - 尝试重新创建模板文件

3. **中文显示问题**
   - 确保Word文档使用UTF-8编码
   - 检查字体设置

#### 调试信息

系统会在浏览器控制台输出详细的调试信息：
- 占位符识别结果
- 文档解析过程
- 错误详情

### 性能优化建议

1. **文件大小**
   - 建议模板文件小于10MB
   - 避免包含大量图片

2. **占位符数量**
   - 建议单个模板不超过50个占位符
   - 复杂模板可能影响处理速度

3. **浏览器兼容性**
   - 推荐使用Chrome、Firefox、Edge最新版本
   - 确保JavaScript已启用

### 示例文件

您可以创建以下几种测试模板：

1. **简单合同模板** - 包含基本的甲乙方信息和金额
2. **复杂合同模板** - 包含表格、条件内容和多种数据类型
3. **表单模板** - 专门用于数据收集的表单格式

### 下一步开发

当前实现的是Phase 1 MVP版本，后续版本将支持：

- **Phase 2**: 表格数据填充、高级数据类型、模板管理
- **Phase 3**: AI智能填充、自然语言处理、智能条款生成

### 技术说明

本地文档处理使用以下技术栈：
- **前端**: React + TypeScript + Tailwind CSS
- **后端**: Next.js API Routes
- **文档处理**: docx-templates + JSZip
- **数据验证**: 自定义验证器

所有处理都在本地完成，确保数据隐私和安全。
